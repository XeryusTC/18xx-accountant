<div *ngIf="gameState.isLoaded()">
	<menu></menu>
	<div class="row nested">
		<div class="tp-9" id="players" *ngIf="gameState.players">
			<div class="section">
				<div class="row">
					<div class="tp-12">
						<h4>Players</h4>
					</div>
				</div>
				<div class="row">
					<div class="tp-2">Name</div>
					<div class="tp-1">Cash</div>
					<div class="tp-9">Shares</div>
				</div>
				<hr />
				<div *ngFor="let player of gameState.players | values:'name'"
					class="player">
					<div class="row" (click)="selectPlayer(player)">
						<div class="tp-2 name">{{ player.name }}</div>
						<div class="tp-1 cash text-right">
							{{ player.cash }}
						</div>
						<div class="tp-9">
							<div *ngFor="let share of gameState.shareInfo(player)"
								class="share fg-{{ share.text_color }}
								bg-{{ share.background_color }}">
								{{ share.name }} {{ share.fraction * 100 }}%
							</div>
						</div>
					</div>
					<div class="row detail"
						*ngIf="selectedPlayer===player.uuid">
						<div class="tp-12">
							<transfer-form [source]="player"></transfer-form>
						</div>
						<div class="tp-12">
							<share-form [buyer]="player"></share-form>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="tp-9" *ngIf="!gameState.players">
			<h4>Loading players...</h4>
		</div>

		<div class="tp-3">
			<bank-detail></bank-detail>
		</div>
	</div>

	<div class="section" *ngIf="gameState.companies">
		<div class="row">
			<div class="tp-12">
				<h4>Companies</h4>
			</div>
		</div>
		<div class="row">
			<div class="tp-2">Name</div>
			<div class="tp-1">Cash</div>
			<div class="tp-1"># Shares</div>
			<div class="tp-1">In IPO</div>
			<div class="tp-1">In Bank</div>
			<div class="tp-1">Value</div>
			<div class="tp-4">Shares</div>
		</div>
		<hr />
		<div *ngFor="let company of gameState.companies | values:'name'"
			class="company">
			<div class="row bg-{{company.background_color}}
			fg-{{company.text_color}}" (click)="selectCompany(company)">
				<div class="tp-2 name">{{ company.name }}</div>
				<div class="tp-1 cash text-right">{{ company.cash }}</div>
				<div class="tp-1 share_count">
					{{ company.share_count }}
				</div>
				<div class="tp-1 ipo">{{ company.ipo_shares }}</div>
				<div class="tp-1 bank">{{ company.bank_shares }}</div>
				<div class="tp-1 value">
					<input type="number" [(ngModel)]="company.value">
				</div>
				<div class="tp-4">
					<div *ngFor="let share of gameState.shareInfo(company)"
						class="share">
						{{ share.name }} {{ share.fraction * 100 }}%
					</div>
			</div>
			<div class="row detail" *ngIf="selectedCompany===company.uuid">
				<transfer-form [source]="company"></transfer-form>
			</div>
		</div>
	</div>
	<div class="section" *ngIf="!gameState.companies">
		<h4>Loading companies...</h4>
	</div>
</div>

<div *ngIf="!gameState.isLoaded()">
	Loading game...
</div>
